buildscript {
    repositories {
        maven { url = 'https://files.minecraftforge.net/maven' }
        jcenter()
        mavenCentral()
    }
    dependencies {
        classpath group: 'net.minecraftforge.gradle', name: 'ForgeGradle', version: '3.+', changing: true
    }
}

apply from: "properties.gradle"

//plugins {
//    id 'net.minecrell.licenser' version '0.3'
//}

apply plugin: 'net.minecraftforge.gradle'
apply plugin: 'eclipse'

apply plugin: 'maven-publish'

// === CHANGE BELOW HERE === //

version = modVersion 
group = modGroup
archivesBaseName = modBaseName
ext.versionTag = ''

sourceCompatibility = targetCompatibility = compileJava.sourceCompatibility = compileJava.targetCompatibility = '1.8'

//license { TODO: Re-enable this, just disabling to test ci.
//    header = project.file('HEADER')
//}

minecraft {
    mappings channel: 'snapshot', version: mappingsVersion
}

dependencies {
    minecraft "net.minecraftforge:forge:${forgeVersion}"
}

if (file('private.gradle').exists()) {
    apply from: 'private.gradle'
}

// Borrowed from concrete
// (https://github.com/elytra/concrete)

task buildAll(type: Jar) {
    baseName = 'compound-all'
    from(sourceSets.main.output) {
        include 'com/tridevmc/compound/**'
    }
}

task buildCore(type: Jar) {
    baseName = 'compound-core'
    from(sourceSets.main.output) {
        include 'com/tridevmc/compound/core/**'
    }
}

task buildGui(type: Jar) {
    baseName = 'compound-gui'
    from(sourceSets.main.output) {
        include 'com/tridevmc/compound/gui/**'
    }
}

task buildInventory(type: Jar) {
    baseName = 'compound-inventory'
    from(sourceSets.main.output) {
        include 'com/tridevmc/compound/inventory/**'
    }
}

task buildNetwork(type: Jar) {
    baseName = 'compound-network'
    from(sourceSets.main.output) {
        include 'com/tridevmc/compound/network/**'
    }
}

task buildConfig(type: Jar) {
    baseName = 'compound-config'
    from(sourceSets.main.output) {
        include 'com/tridevmc/compound/config/**'
    }
}

artifacts {
    archives buildAll, buildCore, buildGui, buildInventory, buildNetwork, buildConfig
}

publishing {
    publications {
        all(MavenPublication) {
            groupId 'com.tridevmc.compound'
            artifactId 'compound-all'
            version project.version + versionTag
            artifact buildAll
        }
        core(MavenPublication) {
            groupId 'com.tridevmc.compound'
            artifactId 'compound-core'
            version project.version + versionTag
            artifact buildCore
        }
        block(MavenPublication) {
            groupId 'com.tridevmc.compound'
            artifactId 'compound-gui'
            version project.version + versionTag
            artifact buildGui
        }
        inventory(MavenPublication) {
            groupId 'com.tridevmc.compound'
            artifactId 'compound-inventory'
            version project.version + versionTag
            artifact buildInventory
        }
        network(MavenPublication) {
            groupId 'com.tridevmc.compound'
            artifactId 'compound-network'
            version project.version + versionTag
            artifact buildNetwork
        }
        config(MavenPublication) {
            groupId 'com.tridevmc.compound'
            artifactId 'compound-config'
            version project.version + versionTag
            artifact buildConfig
        }
    }
}
